loadstring("cHJpbnQoIkxvYWRpbmcgU3RhciBIdWIgLS0gQm9vZ2EgQm9vZ2EgUmVib3JuIikKcHJpbnQoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIikKbG9jYWwgTGlicmFyeSA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0QXN5bmMoImh0dHBzOi8vZ2l0aHViLmNvbS8xZG9udGdpdmVhZi9GbHVlbnQtUmVuZXdlZC9yZWxlYXNlcy9kb3dubG9hZC92MS4wL0ZsdWVudC5sdWF1IikpKCkKbG9jYWwgU2F2ZU1hbmFnZXIgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldEFzeW5jKCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vMWRvbnRnaXZlYWYvRmx1ZW50LVJlbmV3ZWQvcmVmcy9oZWFkcy9tYWluL0FkZG9ucy9TYXZlTWFuYWdlci5sdWF1IikpKCkKbG9jYWwgSW50ZXJmYWNlTWFuYWdlciA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0QXN5bmMoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS8xZG9udGdpdmVhZi9GbHVlbnQtUmVuZXdlZC9yZWZzL2hlYWRzL21haW4vQWRkb25zL0ludGVyZmFjZU1hbmFnZXIubHVhdSIpKSgpCiAKbG9jYWwgV2luZG93ID0gTGlicmFyeTpDcmVhdGVXaW5kb3d7CiAgICBUaXRsZSA9ICJTdGFyIEh1YiAtLSBCb29nYSBCb29nYSBSZWJvcm4iLAogICAgU3ViVGl0bGUgPSAiYnkgT3duZXIgU3RhcnMiLAogICAgVGFiV2lkdGggPSAxNjAsCiAgICBTaXplID0gVURpbTIuZnJvbU9mZnNldCg4MzAsIDUyNSksCiAgICBSZXNpemUgPSB0cnVlLAogICAgTWluU2l6ZSA9IFZlY3RvcjIubmV3KDQ3MCwgMzgwKSwKICAgIEFjcnlsaWMgPSB0cnVlLAogICAgVGhlbWUgPSAiRGFyayIsCiAgICBNaW5pbWl6ZUtleSA9IEVudW0uS2V5Q29kZS5MZWZ0Q29udHJvbAp9Cgpsb2NhbCBUYWJzID0gewogICAgTWFpbiA9IFdpbmRvdzpBZGRUYWIoeyBUaXRsZSA9ICJNYWluIiwgSWNvbiA9ICJtZW51IiB9KSwKICAgIENvbWJhdCA9IFdpbmRvdzpBZGRUYWIoeyBUaXRsZSA9ICJDb21iYXQiLCBJY29uID0gImF4ZSIgfSksCiAgICBNYXAgPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiTWFwIiwgSWNvbiA9ICJ0cmVlcyIgfSksCiAgICBQaWNrdXAgPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiUGlja3VwIiwgSWNvbiA9ICJiYWNrcGFjayIgfSksCiAgICBGYXJtaW5nID0gV2luZG93OkFkZFRhYih7IFRpdGxlID0gIkZhcm1pbmciLCBJY29uID0gInNwcm91dCIgfSksCiAgICBFeHRyYSA9IFdpbmRvdzpBZGRUYWIoeyBUaXRsZSA9ICJFeHRyYSIsIEljb24gPSAicGx1cyIgfSksCglTZXR0aW5ncyA9IFdpbmRvdzpBZGRUYWIoeyBUaXRsZSA9ICJTZXR0aW5ncyIsIEljb24gPSAic2V0dGluZ3MiIH0pLAoJV2F5cG9pbnRUYWIgPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiV2F5cG9pbnRzIiwgSWNvbiA9ICJ3YXlwb2ludHMiIH0pCn0KCmxvY2FsIHJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCmxvY2FsIHBhY2tldHMgPSByZXF1aXJlKHJzLk1vZHVsZXMuUGFja2V0cykKbG9jYWwgcGxyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIGNoYXIgPSBwbHIuQ2hhcmFjdGVyIG9yIHBsci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKbG9jYWwgcm9vdCA9IGNoYXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKbG9jYWwgaHVtID0gY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIikKbG9jYWwgcnVucyA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCmxvY2FsIGh0dHBzZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJIdHRwU2VydmljZSIpCmxvY2FsIFBsYXllcnMgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKQpsb2NhbCBsb2NhbGlzZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJMb2NhbGl6YXRpb25TZXJ2aWNlIikKbG9jYWwgbWFya2V0c2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiTWFya2V0cGxhY2VTZXJ2aWNlIikKbG9jYWwgcmJ4c2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiUmJ4QW5hbHl0aWNzU2VydmljZSIpCmxvY2FsIHBsYWNlc3RydWN0dXJlCmxvY2FsIHRzcG1vID0gZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKQpsb2NhbCBpdGVtc2xpc3QgPSB7CiJBZHVyaXRlIiwgIkJlcnJ5IiwgIkJsb29kZnJ1aXQiLCAiQmx1ZWZydWl0IiwgIkNvaW4iLCAiRXNzZW5jZSIsICJIaWRlIiwgIkljZSBDdWJlIiwgIklyb24iLCAiSmVsbHkiLCAiTGVhdmVzIiwgIkxvZyIsICJTdGVlbCIsICJTdG9uZSIsICJXb29kIiwgIkdvbGQiLCAiUmF3IEdvbGQiLCAiQ3J5c3RhbCBDaHVuayIsICJSYXcgRW1lcmFsZCIsICJQaW5rIERpYW1vbmQiLCAiUmF3IEFkdXJpdGUiLCAiUmF3IElyb24iLCAiQ29hbCJ9CmxvY2FsIE9wdGlvbnMgPSBMaWJyYXJ5Lk9wdGlvbnMKCi0te01BSU4gVEFCfQoKLS1XYWxrIFNwZWVkCmxvY2FsIHdzdG9nZ2xlID0gVGFicy5NYWluOkNyZWF0ZVRvZ2dsZSgid3N0b2dnbGUiLCB7IFRpdGxlID0gIldhbGtzcGVlZCIsIERlZmF1bHQgPSBmYWxzZSB9KQpsb2NhbCB3c3NsaWRlciA9IFRhYnMuTWFpbjpDcmVhdGVTbGlkZXIoIndzc2xpZGVyIiwgeyBUaXRsZSA9ICJWYWx1ZSIsIE1pbiA9IDEsIE1heCA9IDM1LCBSb3VuZGluZyA9IDEsIERlZmF1bHQgPSAxNiB9KQoKLS1KdW1wIFBvd2VyCmxvY2FsIGpwdG9nZ2xlID0gVGFicy5NYWluOkNyZWF0ZVRvZ2dsZSgianB0b2dnbGUiLCB7IFRpdGxlID0gIkp1bXBQb3dlciIsIERlZmF1bHQgPSBmYWxzZSB9KQpsb2NhbCBqcHNsaWRlciA9IFRhYnMuTWFpbjpDcmVhdGVTbGlkZXIoImpwc2xpZGVyIiwgeyBUaXRsZSA9ICJWYWx1ZSIsIE1pbiA9IDEsIE1heCA9IDY1LCBSb3VuZGluZyA9IDEsIERlZmF1bHQgPSA1MCB9KQotLSB1cCBwbGF5ZXIgCmxvY2FsIGhoZWlnaHR0b2dnbGUgPSBUYWJzLk1haW46Q3JlYXRlVG9nZ2xlKCJoaGVpZ2h0dG9nZ2xlIiwgeyBUaXRsZSA9ICJIaXBIZWlnaHQiLCBEZWZhdWx0ID0gZmFsc2UgfSkKbG9jYWwgaGhlaWdodHNsaWRlciA9IFRhYnMuTWFpbjpDcmVhdGVTbGlkZXIoImhoZWlnaHRzbGlkZXIiLCB7IFRpdGxlID0gIlZhbHVlIiwgTWluID0gMC4xLCBNYXggPSA2LjUsIFJvdW5kaW5nID0gMSwgRGVmYXVsdCA9IDIgfSkgCgotLSBObyBNb3VudGFpbiBTbGlwCmxvY2FsIG1zYXRvZ2dsZSA9IFRhYnMuTWFpbjpDcmVhdGVUb2dnbGUoIm1zYXRvZ2dsZSIsIHsgVGl0bGUgPSAiTm8gTW91bnRhaW4gU2xpcCIsIERlZmF1bHQgPSBmYWxzZSB9KQoKVGFicy5NYWluOkNyZWF0ZUJ1dHRvbih7VGl0bGUgPSAiQ29weSBKb2IgSUQiLCBDYWxsYmFjayA9IGZ1bmN0aW9uKCkgc2V0Y2xpcGJvYXJkKGdhbWUuSm9iSWQpIGVuZH0pClRhYnMuTWFpbjpDcmVhdGVCdXR0b24oe1RpdGxlID0gIkNvcHkgSFdJRCIsIENhbGxiYWNrID0gZnVuY3Rpb24oKSBzZXRjbGlwYm9hcmQocmJ4c2VydmljZTpHZXRDbGllbnRJZCgpKSBlbmR9KQpUYWJzLk1haW46Q3JlYXRlQnV0dG9uKHtUaXRsZSA9ICJDb3B5IFNJRCIsIENhbGxiYWNrID0gZnVuY3Rpb24oKSBzZXRjbGlwYm9hcmQocmJ4c2VydmljZTpHZXRTZXNzaW9uSWQoKSkgZW5kfSkKCi0te0NPTUJBVCBUQUJ9CgotLSBLaWxsIEF1cmEKbG9jYWwga2lsbGF1cmF0b2dnbGUgPSBUYWJzLkNvbWJhdDpDcmVhdGVUb2dnbGUoImtpbGxhdXJhdG9nZ2xlIiwgeyBUaXRsZSA9ICJLaWxsIEF1cmEiLCBEZWZhdWx0ID0gZmFsc2UgfSkKbG9jYWwga2lsbGF1cmFyYW5nZXNsaWRlciA9IFRhYnMuQ29tYmF0OkNyZWF0ZVNsaWRlcigia2lsbGF1cmFyYW5nZSIsIHsgVGl0bGUgPSAiUmFuZ2UiLCBNaW4gPSAxLCBNYXggPSA5LCBSb3VuZGluZyA9IDEsIERlZmF1bHQgPSA1IH0pCmxvY2FsIGthdGFyZ2V0Y291bnRkcm9wZG93biA9IFRhYnMuQ29tYmF0OkNyZWF0ZURyb3Bkb3duKCJrYXRhcmdldGNvdW50ZHJvcGRvd24iLCB7IFRpdGxlID0gIk1heCBUYXJnZXRzIiwgVmFsdWVzID0geyAiMSIsICIyIiwgIjMiLCAiNCIsICI1IiwgIjYiIH0sIERlZmF1bHQgPSAiMSIgfSkKbG9jYWwga2Fzd2luZ2Nvb2xkb3duc2xpZGVyID0gVGFicy5Db21iYXQ6Q3JlYXRlU2xpZGVyKCJrYXN3aW5nY29vbGRvd25zbGlkZXIiLCB7IFRpdGxlID0gIkF0dGFjayBDb29sZG93biAocykiLCBNaW4gPSAwLjAxLCBNYXggPSAxLjAxLCBSb3VuZGluZyA9IDIsIERlZmF1bHQgPSAwLjEgfSkKCi0tIEF1dG9IZWFsCmxvY2FsIEhlYWxTZWN0aW9uID0gVGFicy5Db21iYXQ6U2VjdGlvbigiRWF0aW5nIikKbG9jYWwgRWF0VG9nZ2xlID0gSGVhbFNlY3Rpb246QWRkVG9nZ2xlKCJFYXRUb2dnbGUiLCB7IFRpdGxlID0gIkhlYWwiLCBEZWZhdWx0ID0gZmFsc2UgfSkKbG9jYWwgZWF0ZHJvcGRvd24gPSBIZWFsU2VjdGlvbjpBZGREcm9wZG93bigiZWF0ZHJvcGRvd24iLCB7VGl0bGUgPSAiRm9vZCIsIFZhbHVlcyA9IHsiQmxvb2RmcnVpdCIsICJCbHVlZnJ1aXQiLCAiTGVtb24iLCAiQ29jb251dCIsICJKZWxseSIsICJCYW5hbmEiLCAiT3JhbmdlIiwgIk9kZGJlcnJ5IiwgIkJlcnJ5IiwgIlN0cmFuZ2VmcnVpdCIsICJTdHJhd2JlcnJ5IiwgIlN1bmpmcnVpdCIsICJQdW1wa2luIiwgIlByaWNrbHkgUGVhciIsICJBcHBsZSIsICJCYXJsZXkiLCAiQ2xvdWRiZXJyeSIsICJDYXJyb3QifSwgRGVmYXVsdCA9ICJCbG9vZGZydWl0In0pCmxvY2FsIEhlYWx0aENvdW50ID0gSGVhbFNlY3Rpb246Q3JlYXRlU2xpZGVyKCJIZWFsdGhDb3VudCIsIHsgVGl0bGUgPSAiSGVhbHRoIiwgTWluID0gMSwgTWF4ID0gaHVtIGFuZCBodW0uSGVhbHRoIG9yIDEwMCwgUm91bmRpbmcgPSAxLCBEZWZhdWx0ID0gMiB9KQoKLS17TUFQIFRBQn0KCi0tIFJlc291cmNlcyBBdXJhCmxvY2FsIHJlc291cmNlYXVyYXRvZ2dsZSA9IFRhYnMuTWFwOkNyZWF0ZVRvZ2dsZSgicmVzb3VyY2VhdXJhdG9nZ2xlIiwgeyBUaXRsZSA9ICJSZXNvdXJjZSBBdXJhIiwgRGVmYXVsdCA9IGZhbHNlIH0pCmxvY2FsIHJlc291cmNlYXVyYXJhbmdlID0gVGFicy5NYXA6Q3JlYXRlU2xpZGVyKCJyZXNvdXJjZWF1cmFyYW5nZSIsIHsgVGl0bGUgPSAiUmFuZ2UiLCBNaW4gPSAxLCBNYXggPSAyMCwgUm91bmRpbmcgPSAxLCBEZWZhdWx0ID0gMjAgfSkKbG9jYWwgcmVzb3VyY2V0YXJnZXRkcm9wZG93biA9IFRhYnMuTWFwOkNyZWF0ZURyb3Bkb3duKCJyZXNvdXJjZXRhcmdldGRyb3Bkb3duIiwgeyBUaXRsZSA9ICJNYXggVGFyZ2V0cyIsIFZhbHVlcyA9IHsgIjEiLCAiMiIsICIzIiwgIjQiLCAiNSIsICI2IiB9LCBEZWZhdWx0ID0gIjEiIH0pCmxvY2FsIHJlc291cmNlY29vbGRvd25zbGlkZXIgPSBUYWJzLk1hcDpDcmVhdGVTbGlkZXIoInJlc291cmNlY29vbGRvd25zbGlkZXIiLCB7IFRpdGxlID0gIlN3aW5nIENvb2xkb3duIChzKSIsIE1pbiA9IDAuMDEsIE1heCA9IDEuMDEsIFJvdW5kaW5nID0gMiwgRGVmYXVsdCA9IDAuMSB9KSAKCi0tQ3JpdHRlciBBdXJhCmxvY2FsIGNyaXR0ZXJhdXJhdG9nZ2xlID0gVGFicy5NYXA6Q3JlYXRlVG9nZ2xlKCJjcml0dGVyYXVyYXRvZ2dsZSIsIHsgVGl0bGUgPSAiQ3JpdHRlciBBdXJhIiwgRGVmYXVsdCA9IGZhbHNlIH0pCmxvY2FsIGNyaXR0ZXJyYW5nZXNsaWRlciA9IFRhYnMuTWFwOkNyZWF0ZVNsaWRlcigiY3JpdHRlcnJhbmdlc2xpZGVyIiwgeyBUaXRsZSA9ICJSYW5nZSIsIE1pbiA9IDEsIE1heCA9IDIwLCBSb3VuZGluZyA9IDEsIERlZmF1bHQgPSAyMCB9KQpsb2NhbCBjcml0dGVydGFyZ2V0ZHJvcGRvd24gPSBUYWJzLk1hcDpDcmVhdGVEcm9wZG93bigiY3JpdHRlcnRhcmdldGRyb3Bkb3duIiwgeyBUaXRsZSA9ICJNYXggVGFyZ2V0cyIsIFZhbHVlcyA9IHsgIjEiLCAiMiIsICIzIiwgIjQiLCAiNSIsICI2IiB9LCBEZWZhdWx0ID0gIjEiIH0pCmxvY2FsIGNyaXR0ZXJjb29sZG93bnNsaWRlciA9IFRhYnMuTWFwOkNyZWF0ZVNsaWRlcigiY3JpdHRlcmNvb2xkb3duc2xpZGVyIiwgeyBUaXRsZSA9ICJTd2luZyBDb29sZG93biAocykiLCBNaW4gPSAwLjAxLCBNYXggPSAxLjAxLCBSb3VuZGluZyA9IDIsIERlZmF1bHQgPSAwLjEgfSkKCi0te1BJQ0tVUCBUQUJ9CgotLUF1dG8gUGlja1VwCmxvY2FsIGF1dG9waWNrdXB0b2dnbGUgPSBUYWJzLlBpY2t1cDpDcmVhdGVUb2dnbGUoImF1dG9waWNrdXB0b2dnbGUiLCB7IFRpdGxlID0gIkF1dG8gUGlja3VwIiwgRGVmYXVsdCA9IGZhbHNlIH0pCmxvY2FsIGNoZXN0cGlja3VwdG9nZ2xlID0gVGFicy5QaWNrdXA6Q3JlYXRlVG9nZ2xlKCJjaGVzdHBpY2t1cHRvZ2dsZSIsIHsgVGl0bGUgPSAiQXV0byBQaWNrdXAgRnJvbSBDaGVzdHMiLCBEZWZhdWx0ID0gZmFsc2UgfSkKbG9jYWwgcGlja3VwcmFuZ2VzbGlkZXIgPSBUYWJzLlBpY2t1cDpDcmVhdGVTbGlkZXIoInBpY2t1cHJhbmdlIiwgeyBUaXRsZSA9ICJQaWNrdXAgUmFuZ2UiLCBNaW4gPSAxLCBNYXggPSAzNSwgUm91bmRpbmcgPSAxLCBEZWZhdWx0ID0gMjAgfSkKbG9jYWwgaXRlbWRyb3Bkb3duID0gVGFicy5QaWNrdXA6Q3JlYXRlRHJvcGRvd24oIml0ZW1kcm9wZG93biIsIHtUaXRsZSA9ICJJdGVtcyIsIFZhbHVlcyA9IHsiQmVycnkiLCAiQmxvb2RmcnVpdCIsICJCbHVlZnJ1aXQiLCAiU3Bpcml0IEtleSIsICJHbGFzcyIsICJTYW5kIiwgIkxlbW9uIiwgIlN0cmF3YmVycnkiLCAiR29sZCIsICJQdW1wa2luIiwgIlJhdyBHb2xkIiwgIkNyeXN0YWwgQ2h1bmsiLCAiQ29pbiIsICJDb2lucyIsICJDb2luMiIsICJDb2luIFN0YWNrIiwgIkVzc2VuY2UiLCAiRW1lcmFsZCIsICJSYXcgRW1lcmFsZCIsICJQaW5rIERpYW1vbmQiLCAiUmF3IFBpbmsgRGlhbW9uZCIsICJWb2lkIFNoYXJkIiwiSmVsbHkiLCAiTWFnbmV0aXRlIiwgIlJhdyBNYWduZXRpdGUiLCAiQWR1cml0ZSIsICJSYXcgQWR1cml0ZSIsICJJY2UgQ3ViZSIsICJTdG9uZSIsICJJcm9uIiwgIlJhdyBJcm9uIiwgIlN0ZWVsIiwgIkhpZGUiLCAiTGVhdmVzIiwgIkxvZyIsICJXb29kIiwgIlBpZSJ9LCBNdWx0aSA9IHRydWUsIERlZmF1bHQgPSB7IExlYXZlcyA9IHRydWUsIExvZyA9IHRydWUgfX0pCgogLS0gQXV0byBEcm9wCmxvY2FsIGRyb3B0b2dnbGUgPSBUYWJzLlBpY2t1cDpBZGRUb2dnbGUoImRyb3B0b2dnbGUiLCB7IFRpdGxlID0gIkF1dG8gRHJvcCIsIERlZmF1bHQgPSBmYWxzZSB9KQpsb2NhbCBkcm9wZHJvcGRvd24gPSBUYWJzLlBpY2t1cDpBZGREcm9wZG93bigiZHJvcGRyb3Bkb3duIiwge1RpdGxlID0gIlNlbGVjdCBJdGVtIHRvIERyb3AiLCBWYWx1ZXMgPSB7ICJCbG9vZGZydWl0IiwgIkplbGx5IiwgIkJsdWVmcnVpdCIsICJMb2ciLCAiTGVhdmVzIiwgIldvb2QiIH0sIERlZmF1bHQgPSAiQmxvb2RmcnVpdCJ9KQpsb2NhbCBkcm9wdG9nZ2xlbWFudWFsID0gVGFicy5QaWNrdXA6QWRkVG9nZ2xlKCJkcm9wdG9nZ2xlbWFudWFsIiwgeyBUaXRsZSA9ICJBdXRvIERyb3AgQ3VzdG9tIiwgRGVmYXVsdCA9IGZhbHNlIH0pCmxvY2FsIGRyb3B0ZXh0Ym94ID0gVGFicy5QaWNrdXA6QWRkSW5wdXQoImRyb3B0ZXh0Ym94IiwgeyBUaXRsZSA9ICJDdXN0b20gSXRlbSIsIERlZmF1bHQgPSAiQmxvb2RmcnVpdCIsIE51bWVyaWMgPSBmYWxzZSwgRmluaXNoZWQgPSBmYWxzZSB9KQoKLS17V2F5cG9pbnQgVGFifQoKLS1EZWxldGUgT2xkQm9hcmQKbG9jYWwgV2F5cG9pbnRTZWN0aW9uID0gVGFicy5XYXlwb2ludFRhYjpTZWN0aW9uKCJXYWlwb250IikKV2F5cG9pbnRTZWN0aW9uOkNyZWF0ZUJ1dHRvbih7VGl0bGUgPSAiRGVsZXRlIE9sZEJvYXJkcyIsIENhbGxiYWNrID0gZnVuY3Rpb24oKSAKICAgIGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMod29ya3NwYWNlLlJlc291cmNlczpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICBpZiB2Lk5hbWUgPT0gIk9sZCBCb2FyZHMiIGFuZCB3b3Jrc3BhY2UuUmVzb3VyY2VzOkZpbmRGaXJzdENoaWxkKCJPbGQgQm9hcmRzIikgdGhlbgogICAgICAgICAgICAgICAgdjpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZH0pCgotLSBHb2xkZmFybSBDb25maWcKbG9jYWwgQ0ZHU2VjdCA9IFRhYnMuV2F5cG9pbnRUYWI6U2VjdGlvbigiQ29uZmlncyIpCgpsb2NhbCBqYXZhVXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9YRFNDUklQVEVSL0RlZmF1bHRDRkcuanNvbi9yZWZzL2hlYWRzL21haW4vVHdlZW5zQ0ZHMS5qc29uJwoKLS1Nb3ZlIFRvIFBvaW50cwpsb2NhbCBNb3ZlU2VjdGlvbiA9IFRhYnMuV2F5cG9pbnRUYWI6U2VjdGlvbigiTW92aW5nIikKCmxvY2FsIHN0YXJ0TU9WRSA9IE1vdmVTZWN0aW9uOkNyZWF0ZVRvZ2dsZSgiU3RhcnRNb3ZpbmciLCB7IFRpdGxlID0gIlN0YXJ0IE1vdmluZyIsIERlZmF1bHQgPSBmYWxzZSB9KQoKLS17RkFSTUlORyBUQUJ9CgotLUZhcm0gRnJ1aXQKbG9jYWwgZnJ1aXRkcm9wZG93biA9IFRhYnMuRmFybWluZzpDcmVhdGVEcm9wZG93bigiZnJ1aXRkcm9wZG93biIsIHtUaXRsZSA9ICJTZWxlY3QgRnJ1aXQiLFZhbHVlcyA9IHsiQmxvb2RmcnVpdCIsICJCbHVlZnJ1aXQiLCAiTGVtb24iLCAiQ29jb251dCIsICJKZWxseSIsICJCYW5hbmEiLCAiT3JhbmdlIiwgIk9kZGJlcnJ5IiwgIkJlcnJ5IiwgIlN0cmFuZ2VmcnVpdCIsICJTdHJhd2JlcnJ5IiwgIlN1bmpmcnVpdCIsICJQdW1wa2luIiwgIlByaWNrbHkgUGVhciIsICJBcHBsZSIsICAiQmFybGV5IiwgIkNsb3VkYmVycnkiLCAiQ2Fycm90In0sIERlZmF1bHQgPSAiQmxvb2RmcnVpdCJ9KQpsb2NhbCBwbGFudHRvZ2dsZSA9IFRhYnMuRmFybWluZzpDcmVhdGVUb2dnbGUoInBsYW50dG9nZ2xlIiwgeyBUaXRsZSA9ICJBdXRvIFBsYW50IiwgRGVmYXVsdCA9IGZhbHNlIH0pCmxvY2FsIHBsYW50cmFuZ2VzbGlkZXIgPSBUYWJzLkZhcm1pbmc6Q3JlYXRlU2xpZGVyKCJwbGFudHJhbmdlIiwgeyBUaXRsZSA9ICJQbGFudCBSYW5nZSIsIE1pbiA9IDEsIE1heCA9IDMwLCBSb3VuZGluZyA9IDEsIERlZmF1bHQgPSAzMCB9KQpsb2NhbCBwbGFudGRlbGF5c2xpZGVyID0gVGFicy5GYXJtaW5nOkNyZWF0ZVNsaWRlcigicGxhbnRkZWxheSIsIHsgVGl0bGUgPSAiUGxhbnQgRGVsYXkgKHMpIiwgTWluID0gMC4wMSwgTWF4ID0gMSwgUm91bmRpbmcgPSAyLCBEZWZhdWx0ID0gMC4xIH0pCmxvY2FsIGhhcnZlc3R0b2dnbGUgPSBUYWJzLkZhcm1pbmc6Q3JlYXRlVG9nZ2xlKCJoYXJ2ZXN0dG9nZ2xlIiwgeyBUaXRsZSA9ICJBdXRvIEhhcnZlc3QiLCBEZWZhdWx0ID0gZmFsc2UgfSkKbG9jYWwgaGFydmVzdHJhbmdlc2xpZGVyID0gVGFicy5GYXJtaW5nOkNyZWF0ZVNsaWRlcigiaGFydmVzdHJhbmdlIiwgeyBUaXRsZSA9ICJIYXJ2ZXN0IFJhbmdlIiwgTWluID0gMSwgTWF4ID0gMzAsIFJvdW5kaW5nID0gMSwgRGVmYXVsdCA9IDMwIH0pClRhYnMuRmFybWluZzpDcmVhdGVQYXJhZ3JhcGgoIkFsaWduZWQgUGFyYWdyYXBoIiwge1RpdGxlID0gIlR3ZWVuIFN0dWZmIiwgQ29udGVudCA9ICJ3aXNoIHRoaXMgdWkgd2FzIG1vcmUgbGlrZSBsaW5vcmlhIDooIiwgVGl0bGVBbGlnbm1lbnQgPSAiTWlkZGxlIiwgQ29udGVudEFsaWdubWVudCA9IEVudW0uVGV4dFhBbGlnbm1lbnQuQ2VudGVyfSkKbG9jYWwgdHdlZW5wbGFudGJveHRvZ2dsZSA9IFRhYnMuRmFybWluZzpBZGRUb2dnbGUoInR3ZWVudG9wbGFudGJveCIsIHsgVGl0bGUgPSAiVHdlZW4gdG8gUGxhbnQgQm94IiwgRGVmYXVsdCA9IGZhbHNlIH0pCmxvY2FsIHR3ZWVuYnVzaHRvZ2dsZSA9IFRhYnMuRmFybWluZzpBZGRUb2dnbGUoInR3ZWVudG9idXNoIiwgeyBUaXRsZSA9ICJUd2VlbiB0byBCdXNoICsgUGxhbnQgQm94IiwgRGVmYXVsdCA9IGZhbHNlIH0pCmxvY2FsIHR3ZWVucmFuZ2VzbGlkZXIgPSBUYWJzLkZhcm1pbmc6QWRkU2xpZGVyKCJ0d2VlbnJhbmdlIiwgeyBUaXRsZSA9ICJSYW5nZSIsIE1pbiA9IDEsIE1heCA9IDI1MCwgUm91bmRpbmcgPSAxLCBEZWZhdWx0ID0gMjUwIH0pCgotLVBsYW50IEJveApUYWJzLkZhcm1pbmc6Q3JlYXRlUGFyYWdyYXBoKCJBbGlnbmVkIFBhcmFncmFwaCIsIHtUaXRsZSA9ICJQbGFudGJveCBTdHVmZiIsIENvbnRlbnQgPSAid2lzaCB0aGlzIHVpIHdhcyBtb3JlIGxpa2UgbGlub3JpYSA6KCIsIFRpdGxlQWxpZ25tZW50ID0gIk1pZGRsZSIsIENvbnRlbnRBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkNlbnRlcn0pClRhYnMuRmFybWluZzpDcmVhdGVCdXR0b24oe1RpdGxlID0gIlBsYWNlIDE2eDE2IFBsYW50Ym94ZXMgKDI1NikiLCBDYWxsYmFjayA9IGZ1bmN0aW9uKCkgcGxhY2VzdHJ1Y3R1cmUoMTYpIGVuZCB9KQpUYWJzLkZhcm1pbmc6Q3JlYXRlQnV0dG9uKHtUaXRsZSA9ICJQbGFjZSAxNXgxNSBQbGFudGJveGVzICgyMjUpIiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpIHBsYWNlc3RydWN0dXJlKDE1KSBlbmQgfSkKVGFicy5GYXJtaW5nOkNyZWF0ZUJ1dHRvbih7VGl0bGUgPSAiUGxhY2UgMTB4MTAgUGxhbnRib3hlcyAoMTAwKSIsIENhbGxiYWNrID0gZnVuY3Rpb24oKSBwbGFjZXN0cnVjdHVyZSgxMCkgZW5kIH0pClRhYnMuRmFybWluZzpDcmVhdGVCdXR0b24oe1RpdGxlID0gIlBsYWNlIDV4NSBQbGFudGJveGVzICgyNSkiLCBDYWxsYmFjayA9IGZ1bmN0aW9uKCkgcGxhY2VzdHJ1Y3R1cmUoNSkgZW5kIH0pCgotLXtFWFRSQSBUQUJ9ClRhYnMuRXh0cmE6Q3JlYXRlQnV0dG9uKHtUaXRsZSA9ICJJbmZpbml0ZSBZaWVsZCIsIERlc2NyaXB0aW9uID0gImluZiB5aWVsZCBjaGF0IiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGVjcnlwMS9oZXJrbGVzaXkvcmVmcy9oZWFkcy9tYWluL2hpeSIpKSgpZW5kfSkKVGFicy5FeHRyYTpDcmVhdGVCdXR0b24oe1RpdGxlID0gIkZwcyBCb29zdCIsIERlc2NyaXB0aW9uID0gIkZwcyBib29zdGlrIiwgQ2FsbGJhY2sgPSBmdW5jdGlvbigpIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Bhc3RlYmluLmNvbS9yYXcvWDdqS1VnejMiKSkoKWVuZH0pClRhYnMuRXh0cmE6Q3JlYXRlQnV0dG9uKHtUaXRsZSA9ICJBbnRpIEFGSyIsIERlc2NyaXB0aW9uID0gIk5vIEtpY2siLCBDYWxsYmFjayA9IGZ1bmN0aW9uKCkgbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcGFzdGViaW4uY29tL3Jhdy9CQ1NVcTVZYiIpKSgpZW5kfSkKCi0tT3JiaXQKbG9jYWwgb3JiaXR0b2dnbGUgPSBUYWJzLkV4dHJhOkNyZWF0ZVRvZ2dsZSgib3JiaXR0b2dnbGUiLCB7IFRpdGxlID0gIkl0ZW0gT3JiaXQiLCBEZWZhdWx0ID0gZmFsc2UgfSkKbG9jYWwgb3JiaXRyYW5nZXNsaWRlciA9IFRhYnMuRXh0cmE6Q3JlYXRlU2xpZGVyKCJvcmJpdHJhbmdlIiwgeyBUaXRsZSA9ICJHcmFiIFJhbmdlIiwgTWluID0gMSwgTWF4ID0gNTAsIFJvdW5kaW5nID0gMSwgRGVmYXVsdCA9IDIwIH0pCmxvY2FsIG9yYml0cmFkaXVzc2xpZGVyID0gVGFicy5FeHRyYTpDcmVhdGVTbGlkZXIoIm9yYml0cmFkaXVzIiwgeyBUaXRsZSA9ICJPcmJpdCBSYWRpdXMiLCBNaW4gPSAwLCBNYXggPSAzMCwgUm91bmRpbmcgPSAxLCBEZWZhdWx0ID0gMTAgfSkKbG9jYWwgb3JiaXRzcGVlZHNsaWRlciA9IFRhYnMuRXh0cmE6Q3JlYXRlU2xpZGVyKCJvcmJpdHNwZWVkIiwgeyBUaXRsZSA9ICJPcmJpdCBTcGVlZCIsIE1pbiA9IDAsIE1heCA9IDEwLCBSb3VuZGluZyA9IDEsIERlZmF1bHQgPSA1IH0pCmxvY2FsIGl0ZW1oZWlnaHRzbGlkZXIgPSBUYWJzLkV4dHJhOkNyZWF0ZVNsaWRlcigiaXRlbWhlaWdodCIsIHsgVGl0bGUgPSAiSXRlbSBIZWlnaHQiLCBNaW4gPSAtMywgTWF4ID0gMTAsIFJvdW5kaW5nID0gMSwgRGVmYXVsdCA9IDMgfSkKLS17RU5EIE9GIFRBQiBFTEVNRU5UU30KCmxvY2FsIHdzY29uLCBoaGNvbgpsb2NhbCBmdW5jdGlvbiB1cGR3cygpCiAgICBpZiB3c2NvbiB0aGVuIHdzY29uOkRpc2Nvbm5lY3QoKSBlbmQKCiAgICBpZiBPcHRpb25zLndzdG9nZ2xlLlZhbHVlIG9yIE9wdGlvbnMuanB0b2dnbGUuVmFsdWUgdGhlbgogICAgICAgIHdzY29uID0gcnVucy5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBodW0gdGhlbgogICAgICAgICAgICAgICAgaHVtLldhbGtTcGVlZCA9IE9wdGlvbnMud3N0b2dnbGUuVmFsdWUgYW5kIE9wdGlvbnMud3NzbGlkZXIuVmFsdWUgb3IgMTYKICAgICAgICAgICAgICAgIGh1bS5KdW1wUG93ZXIgPSBPcHRpb25zLmpwdG9nZ2xlLlZhbHVlIGFuZCBPcHRpb25zLmpwc2xpZGVyLlZhbHVlIG9yIDUwCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHVwZGhoKCkKICAgIGlmIGhoY29uIHRoZW4gaGhjb246RGlzY29ubmVjdCgpIGVuZAoKICAgIGlmIE9wdGlvbnMuaGhlaWdodHRvZ2dsZS5WYWx1ZSB0aGVuCiAgICAgICAgaGhjb24gPSBydW5zLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIGh1bSB0aGVuCiAgICAgICAgICAgICAgICBodW0uSGlwSGVpZ2h0ID0gT3B0aW9ucy5oaGVpZ2h0c2xpZGVyLlZhbHVlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIG9ucGxyYWRkZWQobmV3Q2hhcikKICAgIGNoYXIgPSBuZXdDaGFyCiAgICByb290ID0gY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgaHVtID0gY2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIikKCiAgICB1cGR3cygpCiAgICB1cGRoaCgpCmVuZAoKcGxyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3Qob25wbHJhZGRlZCkKT3B0aW9ucy53c3RvZ2dsZTpPbkNoYW5nZWQodXBkd3MpCk9wdGlvbnMuanB0b2dnbGU6T25DaGFuZ2VkKHVwZHdzKQpPcHRpb25zLmhoZWlnaHR0b2dnbGU6T25DaGFuZ2VkKHVwZGhoKQoKbG9jYWwgc2xvcGVjb24KbG9jYWwgZnVuY3Rpb24gdXBkbXNhKCkKICAgIGlmIHNsb3BlY29uIHRoZW4gc2xvcGVjb246RGlzY29ubmVjdCgpIGVuZAoKICAgIGlmIE9wdGlvbnMubXNhdG9nZ2xlLlZhbHVlIHRoZW4KICAgICAgICBzbG9wZWNvbiA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIGh1bSB0aGVuCiAgICAgICAgICAgICAgICBodW0uTWF4U2xvcGVBbmdsZSA9IDkwCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVsc2UKICAgICAgICBpZiBodW0gdGhlbgogICAgICAgICAgICBodW0uTWF4U2xvcGVBbmdsZSA9IDQ2CiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpPcHRpb25zLm1zYXRvZ2dsZTpPbkNoYW5nZWQodXBkbXNhKQoKbG9jYWwgZnVuY3Rpb24gZ2V0bGF5b3V0KGl0ZW1uYW1lKQogICAgbG9jYWwgaW52ZW50b3J5ID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLk1haW5HdWkuUmlnaHRQYW5lbC5JbnZlbnRvcnk6RmluZEZpcnN0Q2hpbGQoIkxpc3QiKQogICAgaWYgbm90IGludmVudG9yeSB0aGVuCiAgICAgICAgcmV0dXJuIG5pbAogICAgZW5kCiAgICBmb3IgXywgY2hpbGQgaW4gaXBhaXJzKGludmVudG9yeTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIGNoaWxkOklzQSgiSW1hZ2VMYWJlbCIpIGFuZCBjaGlsZC5OYW1lID09IGl0ZW1uYW1lIHRoZW4KICAgICAgICAgICAgcmV0dXJuIGNoaWxkLkxheW91dE9yZGVyCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBuaWwKZW5kCgpsb2NhbCBmdW5jdGlvbiBzd2luZ3Rvb2wodHNwbW9nbmdpY2wpCiAgICBpZiBwYWNrZXRzLlN3aW5nVG9vbCBhbmQgcGFja2V0cy5Td2luZ1Rvb2wuc2VuZCB0aGVuCiAgICAgICAgcGFja2V0cy5Td2luZ1Rvb2wuc2VuZCh0c3Btb2duZ2ljbCkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHBpY2t1cChlbnRpdHlpZCkKICAgIGlmIHBhY2tldHMuUGlja3VwIGFuZCBwYWNrZXRzLlBpY2t1cC5zZW5kIHRoZW4KICAgICAgICBwYWNrZXRzLlBpY2t1cC5zZW5kKGVudGl0eWlkKQogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gZHJvcChpdGVtbmFtZSkKICAgIGxvY2FsIGludmVudG9yeSA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5NYWluR3VpLlJpZ2h0UGFuZWwuSW52ZW50b3J5OkZpbmRGaXJzdENoaWxkKCJMaXN0IikKICAgIGlmIG5vdCBpbnZlbnRvcnkgdGhlbiByZXR1cm4gZW5kCgogICAgZm9yIF8sIGNoaWxkIGluIGlwYWlycyhpbnZlbnRvcnk6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBjaGlsZDpJc0EoIkltYWdlTGFiZWwiKSBhbmQgY2hpbGQuTmFtZSA9PSBpdGVtbmFtZSB0aGVuCiAgICAgICAgICAgIGlmIHBhY2tldHMgYW5kIHBhY2tldHMuRHJvcEJhZ0l0ZW0gYW5kIHBhY2tldHMuRHJvcEJhZ0l0ZW0uc2VuZCB0aGVuCiAgICAgICAgICAgICAgICBwYWNrZXRzLkRyb3BCYWdJdGVtLnNlbmQoY2hpbGQuTGF5b3V0T3JkZXIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgc2VsZWN0ZWRpdGVtcyA9IHt9Cml0ZW1kcm9wZG93bjpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpCiAgICBzZWxlY3RlZGl0ZW1zID0ge30gCiAgICBmb3IgaXRlbSwgU3RhdGUgaW4gcGFpcnMoVmFsdWUpIGRvCiAgICAgICAgaWYgU3RhdGUgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQoc2VsZWN0ZWRpdGVtcywgaXRlbSkKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgpsb2NhbCBmdW5jdGlvbiBnZXRsYXlvdXQoaXRlbW5hbWUpCiAgICBsb2NhbCBpbnZlbnRvcnkgPSBwbHIuUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJNYWluR3VpIikgYW5kIHBsci5QbGF5ZXJHdWkuTWFpbkd1aTpGaW5kRmlyc3RDaGlsZCgiUmlnaHRQYW5lbCIpIGFuZCBwbHIuUGxheWVyR3VpLk1haW5HdWkuUmlnaHRQYW5lbDpGaW5kRmlyc3RDaGlsZCgiSW52ZW50b3J5IikgYW5kIHBsci5QbGF5ZXJHdWkuTWFpbkd1aS5SaWdodFBhbmVsLkludmVudG9yeTpGaW5kRmlyc3RDaGlsZCgiTGlzdCIpCiAgICBpZiBpbnZlbnRvcnkgdGhlbgogICAgICAgIGZvciBfLCBjaGlsZCBpbiBpcGFpcnMoaW52ZW50b3J5OkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIGNoaWxkOklzQSgiSW1hZ2VMYWJlbCIpIGFuZCBjaGlsZC5OYW1lID09IGl0ZW1uYW1lIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5MYXlvdXRPcmRlcgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIG1vdmVUb1dheXBvaW50U3RhbmQod2F5cG9pbnQpCiAgICBsb2NhbCBodW1hbm9pZCA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgaHVtYW5vaWQ6TW92ZVRvKHdheXBvaW50LlBvc2l0aW9uKQogICAgZW5kCmVuZAogCmxvY2FsIGZ1bmN0aW9uIG1vdmVUb1dheXBvaW50c1N0YW5kKCkKICAgIGlmIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyIGFuZCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiRG90c0ZvbGRlciIpIHRoZW4KICAgICAgICBmb3IgXywgd2F5cG9pbnQgaW4gaXBhaXJzKHdvcmtzcGFjZS5Eb3RzRm9sZGVyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHdheXBvaW50Lk5hbWUgfj0gIkNvdW50ZXIiIGFuZCB3YXlwb2ludC5OYW1lIH49ICJIaWdobGlnaHQiIGFuZCB3YXlwb2ludC5OYW1lIH49ICJIb3dNdWNoIiB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgICAgIG1vdmVUb1dheXBvaW50U3RhbmQod2F5cG9pbnQpCiAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWQuTW92ZVRvRmluaXNoZWQ6V2FpdCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCiAKc3RhcnRNT1ZFOk9uQ2hhbmdlZChmdW5jdGlvbigpCiAgICBpZiBPcHRpb25zLlN0YXJ0TW92aW5nLlZhbHVlIHRoZW4KICAgICAgICBtb3ZlVG9XYXlwb2ludHNTdGFuZCgpCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIE9wdGlvbnMuU3RhcnRNb3ZpbmcuVmFsdWUgZG8KICAgICAgICAgICAgICAgIG1vdmVUb1dheXBvaW50c1N0YW5kKCkKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICAgICAgICAgIGlmIGh1bWFub2lkIGFuZCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBodW1hbm9pZDpNb3ZlVG8oZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAplbmQpCgpsb2NhbCBmdW5jdGlvbiB1c2VJdGVtKGl0ZW1uYW1lKQogICAgbG9jYWwgbGF5b3V0ID0gZ2V0bGF5b3V0KGl0ZW1uYW1lKQogICAgaWYgbGF5b3V0IGFuZCBwYWNrZXRzLlVzZUJhZ0l0ZW0gYW5kIHBhY2tldHMuVXNlQmFnSXRlbS5zZW5kIHRoZW4KICAgICAgICBwYWNrZXRzLlVzZUJhZ0l0ZW0uc2VuZChsYXlvdXQpCiAgICBlbmQKZW5kCiAKcnVucy5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICBpZiBPcHRpb25zLkVhdFRvZ2dsZS5WYWx1ZSBhbmQgaHVtIGFuZCBodW0uSGVhbHRoIDw9IE9wdGlvbnMuSGVhbHRoQ291bnQuVmFsdWUgdGhlbgogICAgICAgIHVzZUl0ZW0oT3B0aW9ucy5lYXRkcm9wZG93bi5WYWx1ZSkKICAgIGVuZAplbmQpCgp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBpZiBub3QgT3B0aW9ucy5raWxsYXVyYXRvZ2dsZS5WYWx1ZSB0aGVuCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIHJhbmdlID0gdG9udW1iZXIoT3B0aW9ucy5raWxsYXVyYXJhbmdlLlZhbHVlKSBvciAyMAogICAgICAgIGxvY2FsIHRhcmdldENvdW50ID0gdG9udW1iZXIoT3B0aW9ucy5rYXRhcmdldGNvdW50ZHJvcGRvd24uVmFsdWUpIG9yIDEKICAgICAgICBsb2NhbCBjb29sZG93biA9IHRvbnVtYmVyKE9wdGlvbnMua2Fzd2luZ2Nvb2xkb3duc2xpZGVyLlZhbHVlKSBvciAwLjEKICAgICAgICBsb2NhbCB0YXJnZXRzID0ge30KCiAgICAgICAgZm9yIF8sIHBsYXllciBpbiBwYWlycyhnYW1lLlBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICBpZiBwbGF5ZXIgfj0gcGxyIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHBsYXllcmZvbGRlciA9IHdvcmtzcGFjZS5QbGF5ZXJzOkZpbmRGaXJzdENoaWxkKHBsYXllci5OYW1lKQogICAgICAgICAgICAgICAgaWYgcGxheWVyZm9sZGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCByb290cGFydCA9IHBsYXllcmZvbGRlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZW50aXR5aWQgPSBwbGF5ZXJmb2xkZXI6R2V0QXR0cmlidXRlKCJFbnRpdHlJRCIpCgogICAgICAgICAgICAgICAgICAgIGlmIHJvb3RwYXJ0IGFuZCBlbnRpdHlpZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAocm9vdHBhcnQuUG9zaXRpb24gLSByb290LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGlzdCA8PSByYW5nZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQodGFyZ2V0cywgeyBlaWQgPSBlbnRpdHlpZCwgZGlzdCA9IGRpc3QgfSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIGlmICN0YXJnZXRzID4gMCB0aGVuCiAgICAgICAgICAgIHRhYmxlLnNvcnQodGFyZ2V0cywgZnVuY3Rpb24oYSwgYikKICAgICAgICAgICAgICAgIHJldHVybiBhLmRpc3QgPCBiLmRpc3QKICAgICAgICAgICAgZW5kKQoKICAgICAgICAgICAgbG9jYWwgc2VsZWN0ZWRUYXJnZXRzID0ge30KICAgICAgICAgICAgZm9yIGkgPSAxLCBtYXRoLm1pbih0YXJnZXRDb3VudCwgI3RhcmdldHMpIGRvCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoc2VsZWN0ZWRUYXJnZXRzLCB0YXJnZXRzW2ldLmVpZCkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBzd2luZ3Rvb2woc2VsZWN0ZWRUYXJnZXRzKQogICAgICAgIGVuZAoKICAgICAgICB0YXNrLndhaXQoY29vbGRvd24pCiAgICBlbmQKZW5kKQoKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgaWYgbm90IE9wdGlvbnMucmVzb3VyY2VhdXJhdG9nZ2xlLlZhbHVlIHRoZW4KICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgY29udGludWUKICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgcmFuZ2UgPSB0b251bWJlcihPcHRpb25zLnJlc291cmNlYXVyYXJhbmdlLlZhbHVlKSBvciAyMAogICAgICAgIGxvY2FsIHRhcmdldENvdW50ID0gdG9udW1iZXIoT3B0aW9ucy5yZXNvdXJjZXRhcmdldGRyb3Bkb3duLlZhbHVlKSBvciAxCiAgICAgICAgbG9jYWwgY29vbGRvd24gPSB0b251bWJlcihPcHRpb25zLnJlc291cmNlY29vbGRvd25zbGlkZXIuVmFsdWUpIG9yIDAuMQogICAgICAgIGxvY2FsIHRhcmdldHMgPSB7fQogICAgICAgIGxvY2FsIGFsbHJlc291cmNlcyA9IHt9CgogICAgICAgIGZvciBfLCByIGluIHBhaXJzKHdvcmtzcGFjZS5SZXNvdXJjZXM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KGFsbHJlc291cmNlcywgcikKICAgICAgICBlbmQKICAgICAgICBmb3IgXywgciBpbiBwYWlycyh3b3Jrc3BhY2U6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgcjpJc0EoIk1vZGVsIikgYW5kIHIuTmFtZSA9PSAiR29sZCBOb2RlIiB0aGVuCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoYWxscmVzb3VyY2VzLCByKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgZm9yIF8sIHJlcyBpbiBwYWlycyhhbGxyZXNvdXJjZXMpIGRvCiAgICAgICAgICAgIGlmIHJlczpJc0EoIk1vZGVsIikgYW5kIHJlczpHZXRBdHRyaWJ1dGUoIkVudGl0eUlEIikgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZWlkID0gcmVzOkdldEF0dHJpYnV0ZSgiRW50aXR5SUQiKQogICAgICAgICAgICAgICAgbG9jYWwgcHBhcnQgPSByZXMuUHJpbWFyeVBhcnQgb3IgcmVzOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJhc2VQYXJ0IikKICAgICAgICAgICAgICAgIGlmIHBwYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkaXN0ID0gKHBwYXJ0LlBvc2l0aW9uIC0gcm9vdC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICAgICAgaWYgZGlzdCA8PSByYW5nZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydCh0YXJnZXRzLCB7IGVpZCA9IGVpZCwgZGlzdCA9IGRpc3QgfSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgaWYgI3RhcmdldHMgPiAwIHRoZW4KICAgICAgICAgICAgdGFibGUuc29ydCh0YXJnZXRzLCBmdW5jdGlvbihhLCBiKQogICAgICAgICAgICAgICAgcmV0dXJuIGEuZGlzdCA8IGIuZGlzdAogICAgICAgICAgICBlbmQpCgogICAgICAgICAgICBsb2NhbCBzZWxlY3RlZFRhcmdldHMgPSB7fQogICAgICAgICAgICBmb3IgaSA9IDEsIG1hdGgubWluKHRhcmdldENvdW50LCAjdGFyZ2V0cykgZG8KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChzZWxlY3RlZFRhcmdldHMsIHRhcmdldHNbaV0uZWlkKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHN3aW5ndG9vbChzZWxlY3RlZFRhcmdldHMpCiAgICAgICAgZW5kCgogICAgICAgIHRhc2sud2FpdChjb29sZG93bikKICAgIGVuZAplbmQpCgp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBpZiBub3QgT3B0aW9ucy5jcml0dGVyYXVyYXRvZ2dsZS5WYWx1ZSB0aGVuCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIHJhbmdlID0gdG9udW1iZXIoT3B0aW9ucy5jcml0dGVycmFuZ2VzbGlkZXIuVmFsdWUpIG9yIDIwCiAgICAgICAgbG9jYWwgdGFyZ2V0Q291bnQgPSB0b251bWJlcihPcHRpb25zLmNyaXR0ZXJ0YXJnZXRkcm9wZG93bi5WYWx1ZSkgb3IgMQogICAgICAgIGxvY2FsIGNvb2xkb3duID0gdG9udW1iZXIoT3B0aW9ucy5jcml0dGVyY29vbGRvd25zbGlkZXIuVmFsdWUpIG9yIDAuMQogICAgICAgIGxvY2FsIHRhcmdldHMgPSB7fQoKICAgICAgICBmb3IgXywgY3JpdHRlciBpbiBwYWlycyh3b3Jrc3BhY2UuQ3JpdHRlcnM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgY3JpdHRlcjpJc0EoIk1vZGVsIikgYW5kIGNyaXR0ZXI6R2V0QXR0cmlidXRlKCJFbnRpdHlJRCIpIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGVpZCA9IGNyaXR0ZXI6R2V0QXR0cmlidXRlKCJFbnRpdHlJRCIpCiAgICAgICAgICAgICAgICBsb2NhbCBwcGFydCA9IGNyaXR0ZXIuUHJpbWFyeVBhcnQgb3IgY3JpdHRlcjpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJCYXNlUGFydCIpCgogICAgICAgICAgICAgICAgaWYgcHBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAocHBhcnQuUG9zaXRpb24gLSByb290LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICBpZiBkaXN0IDw9IHJhbmdlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHRhcmdldHMsIHsgZWlkID0gZWlkLCBkaXN0ID0gZGlzdCB9KQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBpZiAjdGFyZ2V0cyA-IDAgdGhlbgogICAgICAgICAgICB0YWJsZS5zb3J0KHRhcmdldHMsIGZ1bmN0aW9uKGEsIGIpCiAgICAgICAgICAgICAgICByZXR1cm4gYS5kaXN0IDwgYi5kaXN0CiAgICAgICAgICAgIGVuZCkKCiAgICAgICAgICAgIGxvY2FsIHNlbGVjdGVkVGFyZ2V0cyA9IHt9CiAgICAgICAgICAgIGZvciBpID0gMSwgbWF0aC5taW4odGFyZ2V0Q291bnQsICN0YXJnZXRzKSBkbwogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHNlbGVjdGVkVGFyZ2V0cywgdGFyZ2V0c1tpXS5laWQpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgc3dpbmd0b29sKHNlbGVjdGVkVGFyZ2V0cykKICAgICAgICBlbmQKCiAgICAgICAgdGFzay53YWl0KGNvb2xkb3duKQogICAgZW5kCmVuZCkKCgoKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgbG9jYWwgcmFuZ2UgPSB0b251bWJlcihPcHRpb25zLnBpY2t1cHJhbmdlLlZhbHVlKSBvciAzNQoKICAgICAgICBpZiBPcHRpb25zLmF1dG9waWNrdXB0b2dnbGUuVmFsdWUgdGhlbgogICAgICAgICAgICBmb3IgXywgaXRlbSBpbiBpcGFpcnMod29ya3NwYWNlLkl0ZW1zOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBpdGVtOklzQSgiQmFzZVBhcnQiKSBvciBpdGVtOklzQSgiTWVzaFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2VsZWN0ZWRpdGVtID0gaXRlbS5OYW1lCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZW50aXR5aWQgPSBpdGVtOkdldEF0dHJpYnV0ZSgiRW50aXR5SUQiKQoKICAgICAgICAgICAgICAgICAgICBpZiBlbnRpdHlpZCBhbmQgdGFibGUuZmluZChzZWxlY3RlZGl0ZW1zLCBzZWxlY3RlZGl0ZW0pIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChpdGVtLlBvc2l0aW9uIC0gcm9vdC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRpc3QgPD0gcmFuZ2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGlja3VwKGVudGl0eWlkKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgaWYgT3B0aW9ucy5jaGVzdHBpY2t1cHRvZ2dsZS5WYWx1ZSB0aGVuCiAgICAgICAgICAgIGZvciBfLCBjaGVzdCBpbiBpcGFpcnMod29ya3NwYWNlLkRlcGxveWFibGVzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBjaGVzdDpJc0EoIk1vZGVsIikgYW5kIGNoZXN0OkZpbmRGaXJzdENoaWxkKCJDb250ZW50cyIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgaXRlbSBpbiBpcGFpcnMoY2hlc3QuQ29udGVudHM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXRlbTpJc0EoIkJhc2VQYXJ0Iikgb3IgaXRlbTpJc0EoIk1lc2hQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2VsZWN0ZWRpdGVtID0gaXRlbS5OYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBlbnRpdHlpZCA9IGl0ZW06R2V0QXR0cmlidXRlKCJFbnRpdHlJRCIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZW50aXR5aWQgYW5kIHRhYmxlLmZpbmQoc2VsZWN0ZWRpdGVtcywgc2VsZWN0ZWRpdGVtKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChjaGVzdC5QcmltYXJ5UGFydC5Qb3NpdGlvbiAtIHJvb3QuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRpc3QgPD0gcmFuZ2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaWNrdXAoZW50aXR5aWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIHRhc2sud2FpdCgwLjAxKQogICAgZW5kCmVuZCkKCmxvY2FsIGRlYm91bmNlID0gMApsb2NhbCBjZCA9IDAgLS0gaSBnZW51aW5lbHkgZG9udCBrbm93IHdoeSBpdCBicmVha3Mgbm93LCBidXQgdHVybiB0aGlzIHVwIHRvIDAuMyAtIDAuMiB0byBzdG9wIGl0IGZyb20gZHJvcHBpbmcgb3RoZXIgaXRlbXMKcnVucy5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICBpZiBPcHRpb25zLmRyb3B0b2dnbGUuVmFsdWUgdGhlbgogICAgICAgIGlmIHRpY2soKSAtIGRlYm91bmNlID49IGNkIHRoZW4KICAgICAgICAgICAgbG9jYWwgc2VsZWN0ZWRJdGVtID0gT3B0aW9ucy5kcm9wZHJvcGRvd24uVmFsdWUKICAgICAgICAgICAgZHJvcChzZWxlY3RlZEl0ZW0pCiAgICAgICAgICAgIGRlYm91bmNlID0gdGljaygpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKcnVucy5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICBpZiBPcHRpb25zLmRyb3B0b2dnbGVtYW51YWwuVmFsdWUgdGhlbgogICAgICAgIGlmIHRpY2soKSAtIGRlYm91bmNlID49IGNkIHRoZW4KICAgICAgICAgICAgbG9jYWwgaXRlbW5hbWUgPSBPcHRpb25zLmRyb3B0ZXh0Ym94LlZhbHVlCiAgICAgICAgICAgIGRyb3AoaXRlbW5hbWUpCiAgICAgICAgICAgIGRlYm91bmNlID0gdGljaygpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKbG9jYWwgcGxhbnRlZGJveGVzID0ge30KbG9jYWwgZnJ1aXR0b2l0ZW1pZCA9IHsKICAgIEJsb29kZnJ1aXQgPSA5NCwKICAgIEJsdWVmcnVpdCA9IDM3NywKICAgIExlbW9uID0gOTksCiAgICBDb2NvbnV0ID0gMSwKICAgIEplbGx5ID0gNjA0LAogICAgQmFuYW5hID0gNjA2LAogICAgT3JhbmdlID0gNjAyLAogICAgT2RkYmVycnkgPSAzMiwKICAgIEJlcnJ5ID0gMzUsCiAgICBTdHJhbmdlZnJ1aXQgPSAzMDIsCiAgICBTdHJhd2JlcnJ5ID0gMjgyLAogICAgU3VuZnJ1aXQgPSAxMjgsCiAgICBQdW1wa2luID0gODAsCiAgICBbIlByaWNrbHkgUGVhciJdID0gMzc4LAogICAgQXBwbGUgPSAyNDMsCiAgICBCYXJsZXkgPSAyNDcsCiAgICBDbG91ZGJlcnJ5ID0gMTAxLAogICAgQ2Fycm90ID0gMTQ3Cn0KCmxvY2FsIGZ1bmN0aW9uIHBsYW50KGVudGl0eWlkLCBpdGVtSUQpCiAgICBpZiBwYWNrZXRzLkludGVyYWN0U3RydWN0dXJlIGFuZCBwYWNrZXRzLkludGVyYWN0U3RydWN0dXJlLnNlbmQgdGhlbgogICAgICAgIHBhY2tldHMuSW50ZXJhY3RTdHJ1Y3R1cmUuc2VuZCh7IGVudGl0eUlEID0gZW50aXR5aWQsIGl0ZW1JRCA9IGl0ZW1JRCB9KQogICAgICAgIHBsYW50ZWRib3hlc1tlbnRpdHlpZF0gPSB0cnVlCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBnZXRwYnMocmFuZ2UpCiAgICBsb2NhbCBwbGFudGJveGVzID0ge30KICAgIGZvciBfLCBkZXBsb3lhYmxlIGluIGlwYWlycyh3b3Jrc3BhY2UuRGVwbG95YWJsZXM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBkZXBsb3lhYmxlOklzQSgiTW9kZWwiKSBhbmQgZGVwbG95YWJsZS5OYW1lID09ICJQbGFudCBCb3giIHRoZW4KICAgICAgICAgICAgbG9jYWwgZW50aXR5aWQgPSBkZXBsb3lhYmxlOkdldEF0dHJpYnV0ZSgiRW50aXR5SUQiKQogICAgICAgICAgICBsb2NhbCBwcGFydCA9IGRlcGxveWFibGUuUHJpbWFyeVBhcnQgb3IgZGVwbG95YWJsZTpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJCYXNlUGFydCIpCiAgICAgICAgICAgIGlmIGVudGl0eWlkIGFuZCBwcGFydCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBkaXN0ID0gKHBwYXJ0LlBvc2l0aW9uIC0gcm9vdC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICBpZiBkaXN0IDw9IHJhbmdlIHRoZW4KICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQocGxhbnRib3hlcywgeyBlbnRpdHlpZCA9IGVudGl0eWlkLCBkZXBsb3lhYmxlID0gZGVwbG95YWJsZSwgZGlzdCA9IGRpc3QgfSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIHBsYW50Ym94ZXMKZW5kCgpsb2NhbCBmdW5jdGlvbiBnZXRidXNoZXMocmFuZ2UsIGZydWl0bmFtZSkKICAgIGxvY2FsIGJ1c2hlcyA9IHt9CiAgICBmb3IgXywgbW9kZWwgaW4gaXBhaXJzKHdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIG1vZGVsOklzQSgiTW9kZWwiKSBhbmQgbW9kZWwuTmFtZTpmaW5kKGZydWl0bmFtZSkgdGhlbgogICAgICAgICAgICBsb2NhbCBwcGFydCA9IG1vZGVsLlByaW1hcnlQYXJ0IG9yIG1vZGVsOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJhc2VQYXJ0IikKICAgICAgICAgICAgaWYgcHBhcnQgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChwcGFydC5Qb3NpdGlvbiAtIHJvb3QuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgaWYgZGlzdCA8PSByYW5nZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZW50aXR5aWQgPSBtb2RlbDpHZXRBdHRyaWJ1dGUoIkVudGl0eUlEIikKICAgICAgICAgICAgICAgICAgICBpZiBlbnRpdHlpZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChidXNoZXMsIHsgZW50aXR5aWQgPSBlbnRpdHlpZCwgbW9kZWwgPSBtb2RlbCwgZGlzdCA9IGRpc3QgfSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIGJ1c2hlcwplbmQKCmxvY2FsIHR3ZWVuaW5nID0gbmlsCmxvY2FsIGZ1bmN0aW9uIHR3ZWVuKHRhcmdldCkKICAgIGlmIHR3ZWVuaW5nIHRoZW4gdHdlZW5pbmc6Q2FuY2VsKCkgZW5kCiAgICBsb2NhbCBkaXN0YW5jZSA9IChyb290LlBvc2l0aW9uIC0gdGFyZ2V0LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgIGxvY2FsIGR1cmF0aW9uID0gZGlzdGFuY2UgLyAyMQogICAgbG9jYWwgdHdlZW5JbmZvID0gVHdlZW5JbmZvLm5ldyhkdXJhdGlvbiwgRW51bS5FYXNpbmdTdHlsZS5MaW5lYXIpCiAgICBsb2NhbCB0d2VlbiA9IHRzcG1vOkNyZWF0ZShyb290LCB0d2VlbkluZm8sIHsgQ0ZyYW1lID0gdGFyZ2V0IH0pCiAgICB0d2VlbjpQbGF5KCkKICAgIAogICAgdHdlZW5pbmcgPSB0d2VlbgplbmQKCmxvY2FsIGZ1bmN0aW9uIHR3ZWVucGxhbnRib3gocmFuZ2UpCiAgICB3aGlsZSB0d2VlbnBsYW50Ym94dG9nZ2xlLlZhbHVlIGRvCiAgICAgICAgbG9jYWwgcGxhbnRib3hlcyA9IGdldHBicyhyYW5nZSkKICAgICAgICB0YWJsZS5zb3J0KHBsYW50Ym94ZXMsIGZ1bmN0aW9uKGEsIGIpIHJldHVybiBhLmRpc3QgPCBiLmRpc3QgZW5kKQoKICAgICAgICBmb3IgXywgYm94IGluIGlwYWlycyhwbGFudGJveGVzKSBkbwogICAgICAgICAgICBpZiBub3QgYm94LmRlcGxveWFibGU6RmluZEZpcnN0Q2hpbGQoIlNlZWQiKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXQgPSBib3guZGVwbG95YWJsZS5QcmltYXJ5UGFydC5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLCA1LCAwKQogICAgICAgICAgICAgICAgdHdlZW4odGFyZ2V0KQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiB0d2VlbnBicyhyYW5nZSwgZnJ1aXRuYW1lKQogICAgd2hpbGUgdHdlZW5idXNodG9nZ2xlLlZhbHVlIGRvCiAgICAgICAgbG9jYWwgYnVzaGVzID0gZ2V0YnVzaGVzKHJhbmdlLCBmcnVpdG5hbWUpCiAgICAgICAgdGFibGUuc29ydChidXNoZXMsIGZ1bmN0aW9uKGEsIGIpIHJldHVybiBhLmRpc3QgPCBiLmRpc3QgZW5kKQoKICAgICAgICBpZiAjYnVzaGVzID4gMCB0aGVuCiAgICAgICAgICAgIGZvciBfLCBidXNoIGluIGlwYWlycyhidXNoZXMpIGRvCiAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXQgPSBidXNoLm1vZGVsLlByaW1hcnlQYXJ0LkNGcmFtZSArIFZlY3RvcjMubmV3KDAsIDUsIDApCiAgICAgICAgICAgICAgICB0d2Vlbih0YXJnZXQpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGxvY2FsIHBsYW50Ym94ZXMgPSBnZXRwYnMocmFuZ2UpCiAgICAgICAgICAgIHRhYmxlLnNvcnQocGxhbnRib3hlcywgZnVuY3Rpb24oYSwgYikgcmV0dXJuIGEuZGlzdCA8IGIuZGlzdCBlbmQpCgogICAgICAgICAgICBmb3IgXywgYm94IGluIGlwYWlycyhwbGFudGJveGVzKSBkbwogICAgICAgICAgICAgICAgaWYgbm90IGJveC5kZXBsb3lhYmxlOkZpbmRGaXJzdENoaWxkKCJTZWVkIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldCA9IGJveC5kZXBsb3lhYmxlLlByaW1hcnlQYXJ0LkNGcmFtZSArIFZlY3RvcjMubmV3KDAsIDUsIDApCiAgICAgICAgICAgICAgICAgICAgdHdlZW4odGFyZ2V0KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICBlbmQKZW5kCgp0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBpZiBub3QgT3B0aW9ucy5wbGFudHRvZ2dsZS5WYWx1ZSB0aGVuCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIHJhbmdlID0gdG9udW1iZXIoT3B0aW9ucy5wbGFudHJhbmdlLlZhbHVlKSBvciAzMAogICAgICAgIGxvY2FsIGRlbGF5ID0gdG9udW1iZXIoT3B0aW9ucy5wbGFudGRlbGF5LlZhbHVlKSBvciAwLjEKICAgICAgICBsb2NhbCBzZWxlY3RlZGZydWl0ID0gT3B0aW9ucy5mcnVpdGRyb3Bkb3duLlZhbHVlCiAgICAgICAgbG9jYWwgaXRlbUlEID0gZnJ1aXR0b2l0ZW1pZFtzZWxlY3RlZGZydWl0XSBvciA5NAogICAgICAgIGxvY2FsIHBsYW50Ym94ZXMgPSBnZXRwYnMocmFuZ2UpCiAgICAgICAgdGFibGUuc29ydChwbGFudGJveGVzLCBmdW5jdGlvbihhLCBiKSByZXR1cm4gYS5kaXN0IDwgYi5kaXN0IGVuZCkKCiAgICAgICAgZm9yIF8sIGJveCBpbiBpcGFpcnMocGxhbnRib3hlcykgZG8KICAgICAgICAgICAgaWYgbm90IGJveC5kZXBsb3lhYmxlOkZpbmRGaXJzdENoaWxkKCJTZWVkIikgdGhlbgogICAgICAgICAgICAgICAgcGxhbnQoYm94LmVudGl0eWlkLCBpdGVtSUQpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHBsYW50ZWRib3hlc1tib3guZW50aXR5aWRdID0gdHJ1ZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICB0YXNrLndhaXQoZGVsYXkpCiAgICBlbmQKZW5kKQoKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgaWYgbm90IE9wdGlvbnMuaGFydmVzdHRvZ2dsZS5WYWx1ZSB0aGVuCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgaGFydmVzdHJhbmdlID0gdG9udW1iZXIoT3B0aW9ucy5oYXJ2ZXN0cmFuZ2UuVmFsdWUpIG9yIDMwCiAgICAgICAgbG9jYWwgc2VsZWN0ZWRmcnVpdCA9IE9wdGlvbnMuZnJ1aXRkcm9wZG93bi5WYWx1ZQogICAgICAgIGxvY2FsIGJ1c2hlcyA9IGdldGJ1c2hlcyhoYXJ2ZXN0cmFuZ2UsIHNlbGVjdGVkZnJ1aXQpCiAgICAgICAgdGFibGUuc29ydChidXNoZXMsIGZ1bmN0aW9uKGEsIGIpIHJldHVybiBhLmRpc3QgPCBiLmRpc3QgZW5kKQogICAgICAgIGZvciBfLCBidXNoIGluIGlwYWlycyhidXNoZXMpIGRvCiAgICAgICAgICAgIHBpY2t1cChidXNoLmVudGl0eWlkKQogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICBlbmQKZW5kKQoKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgaWYgbm90IHR3ZWVucGxhbnRib3h0b2dnbGUuVmFsdWUgdGhlbgogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGVuZAogICAgICAgIGxvY2FsIHJhbmdlID0gdG9udW1iZXIoT3B0aW9ucy50d2VlbnJhbmdlLlZhbHVlKSBvciAyNTAKICAgICAgICB0d2VlbnBsYW50Ym94KHJhbmdlKQogICAgZW5kCmVuZCkKCnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgIGlmIG5vdCB0d2VlbmJ1c2h0b2dnbGUuVmFsdWUgdGhlbgogICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGVuZAogICAgICAgIGxvY2FsIHJhbmdlID0gdG9udW1iZXIoT3B0aW9ucy50d2VlbnJhbmdlLlZhbHVlKSBvciAyMAogICAgICAgIGxvY2FsIHNlbGVjdGVkZnJ1aXQgPSBPcHRpb25zLmZydWl0ZHJvcGRvd24uVmFsdWUKICAgICAgICB0d2VlbnBicyhyYW5nZSwgc2VsZWN0ZWRmcnVpdCkKICAgIGVuZAplbmQpCgpwbGFjZXN0cnVjdHVyZSA9IGZ1bmN0aW9uKGdyaWRzaXplKQogICAgaWYgbm90IHBsciBvciBub3QgcGxyLkNoYXJhY3RlciB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCB0b3JzbyA9IHBsci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgaWYgbm90IHRvcnNvIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIHN0YXJ0cG9zID0gdG9yc28uUG9zaXRpb24gLSBWZWN0b3IzLm5ldygwLCAzLCAwKQogICAgbG9jYWwgc3BhY2luZyA9IDYuMDQKCiAgICBmb3IgeCA9IDAsIGdyaWRzaXplIC0gMSBkbwogICAgICAgIGZvciB6ID0gMCwgZ3JpZHNpemUgLSAxIGRvCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjMpCiAgICAgICAgICAgIGxvY2FsIHBvc2l0aW9uID0gc3RhcnRwb3MgKyBWZWN0b3IzLm5ldyh4ICogc3BhY2luZywgMCwgeiAqIHNwYWNpbmcpCgogICAgICAgICAgICBpZiBwYWNrZXRzLlBsYWNlU3RydWN0dXJlIGFuZCBwYWNrZXRzLlBsYWNlU3RydWN0dXJlLnNlbmQgdGhlbgogICAgICAgICAgICAgICAgcGFja2V0cy5QbGFjZVN0cnVjdHVyZS5zZW5kewogICAgICAgICAgICAgICAgICAgIFsiYnVpbGRpbmdOYW1lIl0gPSAiUGxhbnQgQm94IiwKICAgICAgICAgICAgICAgICAgICBbInlyb3QiXSA9IDQ1LAogICAgICAgICAgICAgICAgICAgIFsidmVjIl0gPSBwb3NpdGlvbiwKICAgICAgICAgICAgICAgICAgICBbImlzTW9iaWxlIl0gPSBmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmxvY2FsIG9yYml0b24sIHJhbmdlLCBvcmJpdHJhZGl1cywgb3JiaXRzcGVlZCwgaXRlbWhlaWdodCA9IGZhbHNlLCAyMCwgMTAsIDUsIDMKbG9jYWwgYXR0YWNoZWRpdGVtcywgaXRlbWFuZ2xlcywgbGFzdHBvc2l0aW9ucyA9IHt9LCB7fSwge30KbG9jYWwgaXRlbXNmb2xkZXIgPSB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJJdGVtcyIpCgpvcmJpdHRvZ2dsZTpPbkNoYW5nZWQoZnVuY3Rpb24odmFsdWUpCiAgICBvcmJpdG9uID0gdmFsdWUKICAgIGlmIG5vdCBvcmJpdG9uIHRoZW4KICAgICAgICBmb3IgXywgYnAgaW4gcGFpcnMoYXR0YWNoZWRpdGVtcykgZG8gYnA6RGVzdHJveSgpIGVuZAogICAgICAgIHRhYmxlLmNsZWFyKGF0dGFjaGVkaXRlbXMpCiAgICAgICAgdGFibGUuY2xlYXIoaXRlbWFuZ2xlcykKICAgICAgICB0YWJsZS5jbGVhcihsYXN0cG9zaXRpb25zKQogICAgZWxzZQogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBvcmJpdG9uIGRvCiAgICAgICAgICAgICAgICBmb3IgaXRlbSwgYnAgaW4gcGFpcnMoYXR0YWNoZWRpdGVtcykgZG8KICAgICAgICAgICAgICAgICAgICBpZiBpdGVtIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgY3VycmVudHBvcyA9IGl0ZW0uUG9zaXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbGFzdHBvcyA9IGxhc3Rwb3NpdGlvbnNbaXRlbV0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxhc3Rwb3MgYW5kIChjdXJyZW50cG9zIC0gbGFzdHBvcykuTWFnbml0dWRlIDwgMC4xIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBhY2tldHMuRm9yY2VJbnRlcmFjdCBhbmQgcGFja2V0cy5Gb3JjZUludGVyYWN0LnNlbmQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhY2tldHMuRm9yY2VJbnRlcmFjdC5zZW5kKGl0ZW06R2V0QXR0cmlidXRlKCJFbnRpdHlJRCIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdHBvc2l0aW9uc1tpdGVtXSA9IGN1cnJlbnRwb3MKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCmVuZCkKCm9yYml0cmFuZ2VzbGlkZXI6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKSByYW5nZSA9IHZhbHVlIGVuZCkKb3JiaXRyYWRpdXNzbGlkZXI6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKSBvcmJpdHJhZGl1cyA9IHZhbHVlIGVuZCkKb3JiaXRzcGVlZHNsaWRlcjpPbkNoYW5nZWQoZnVuY3Rpb24odmFsdWUpIG9yYml0c3BlZWQgPSB2YWx1ZSBlbmQpCml0ZW1oZWlnaHRzbGlkZXI6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKSBpdGVtaGVpZ2h0ID0gdmFsdWUgZW5kKQoKcnVucy5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgaWYgbm90IG9yYml0b24gdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCB0aW1lID0gdGljaygpICogb3JiaXRzcGVlZAogICAgZm9yIGl0ZW0sIGJwIGluIHBhaXJzKGF0dGFjaGVkaXRlbXMpIGRvCiAgICAgICAgaWYgaXRlbSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFuZ2xlID0gaXRlbWFuZ2xlc1tpdGVtXSArIHRpbWUKICAgICAgICAgICAgYnAuUG9zaXRpb24gPSByb290LlBvc2l0aW9uICsgVmVjdG9yMy5uZXcobWF0aC5jb3MoYW5nbGUpICogb3JiaXRyYWRpdXMsIGl0ZW1oZWlnaHQsIG1hdGguc2luKGFuZ2xlKSAqIG9yYml0cmFkaXVzKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCnRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgIGlmIG9yYml0b24gdGhlbgogICAgICAgICAgICBsb2NhbCBjaGlsZHJlbiwgaW5kZXggPSBpdGVtc2ZvbGRlcjpHZXRDaGlsZHJlbigpLCAwCiAgICAgICAgICAgIGxvY2FsIGFuZ2xlc3RlcCA9IChtYXRoLnBpICogMikgLyBtYXRoLm1heCgjY2hpbGRyZW4sIDEpCgogICAgICAgICAgICBmb3IgXywgaXRlbSBpbiBwYWlycyhjaGlsZHJlbikgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHByaW1hcnkgPSBpdGVtOklzQSgiQmFzZVBhcnQiKSBhbmQgaXRlbSBvciBpdGVtOklzQSgiTW9kZWwiKSBhbmQgaXRlbS5QcmltYXJ5UGFydAogICAgICAgICAgICAgICAgaWYgcHJpbWFyeSBhbmQgKHByaW1hcnkuUG9zaXRpb24gLSByb290LlBvc2l0aW9uKS5NYWduaXR1ZGUgPD0gcmFuZ2UgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBhdHRhY2hlZGl0ZW1zW3ByaW1hcnldIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYnAgPSBJbnN0YW5jZS5uZXcoIkJvZHlQb3NpdGlvbiIpCiAgICAgICAgICAgICAgICAgICAgICAgIGJwLk1heEZvcmNlLCBicC5ELCBicC5QLCBicC5QYXJlbnQgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKSwgMTUwMCwgMjUwMDAsIHByaW1hcnkKICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNoZWRpdGVtc1twcmltYXJ5XSwgaXRlbWFuZ2xlc1twcmltYXJ5XSwgbGFzdHBvc2l0aW9uc1twcmltYXJ5XSA9IGJwLCBpbmRleCAqIGFuZ2xlc3RlcCwgcHJpbWFyeS5Qb3NpdGlvbgogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCArPSAxCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KCkKICAgIGVuZAplbmQpCgpTYXZlTWFuYWdlcjpTZXRMaWJyYXJ5KExpYnJhcnkpCkludGVyZmFjZU1hbmFnZXI6U2V0TGlicmFyeShMaWJyYXJ5KQpTYXZlTWFuYWdlcjpJZ25vcmVUaGVtZVNldHRpbmdzKCkKU2F2ZU1hbmFnZXI6U2V0SWdub3JlSW5kZXhlc3t9CkludGVyZmFjZU1hbmFnZXI6U2V0Rm9sZGVyKCJGbHVlbnRTY3JpcHRIdWIiKQpTYXZlTWFuYWdlcjpTZXRGb2xkZXIoIkZsdWVudFNjcmlwdEh1Yi9zcGVjaWZpYy1nYW1lIikKSW50ZXJmYWNlTWFuYWdlcjpCdWlsZEludGVyZmFjZVNlY3Rpb24oVGFicy5TZXR0aW5ncykKU2F2ZU1hbmFnZXI6QnVpbGRDb25maWdTZWN0aW9uKFRhYnMuU2V0dGluZ3MpCldpbmRvdzpTZWxlY3RUYWIoMSkKTGlicmFyeTpOb3RpZnl7CiAgICBUaXRsZSA9ICJTdGFyIEh1YiIsCiAgICBDb250ZW50ID0gIkxvYWRlZCwgRW5qb3khIiwKICAgIER1cmF0aW9uID0gOAp9ClNhdmVNYW5hZ2VyOkxvYWRBdXRvbG9hZENvbmZpZygpCnByaW50KCJEb25lISBFbmpveSBTdGFyIEh1YiEiKQo")
